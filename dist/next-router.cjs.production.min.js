"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var e=t(require("next/router")),r=require("path-to-regexp"),n=require("react"),o=t(require("next/link"));function u(){return(u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){if(null==t)return{};var r,n,o={},u=Object.keys(t);for(n=0;n<u.length;n++)e.indexOf(r=u[n])>=0||(o[r]=t[r]);return o}var s=function(){function t(t,e){this.page=e,this.compiled=r.compile(t,{encode:encodeURIComponent}),this.keys=[],this.regex=r.pathToRegexp(t,this.keys)}var e=t.prototype;return e.valuesToParams=function(t,e){return t.reduce((function(t,r,n){var o;return void 0===r?t:Object.assign(t,((o={})[e[n].name]=decodeURIComponent(r),o))}),{})},e.match=function(t){var e=t.split("#"),r=e[0].split("?"),n=r[0],o={};r.length>1&&(o=function(t){if(!t)return{};var e=t.split("&"),r={};return e.forEach((function(t){var e=t.split("="),n=e[0],o=e[1];n&&(r[n]=o?decodeURIComponent(o):null)})),r}(r[1]));var u=e.length>1?e[1]:"",i=this.regex.exec(n);return null!==i?{params:this.valuesToParams(i.slice(1),this.keys),query:o,hash:u,path:t,page:this.page,matched:!0}:{params:{},query:o,hash:u,path:t,page:"",matched:!1}},e.assemble=function(t){var e=this.compiled(t);return""===e?"/":e.replace(/%23/g,"#")},e.getPage=function(){return this.page},t}(),h=function(){function t(t){var r,n;this.routes={},this.currentRoute=null,this.setRoutes(t),this.events=(r=this,n=Object.create(null),{on:function(t,o){var u=function(t,e){return function(){var r=arguments.length<=0?void 0:arguments[0];arguments.length>1&&"string"==typeof(arguments.length<=1?void 0:arguments[1])&&(r=arguments.length<=1?void 0:arguments[1]);var n=t.match(r),o=t.currentRouteFromMatch(n);1===arguments.length?e(o):e(arguments.length<=0?void 0:arguments[0],o)}}(r,o);e.events.on(t,u),(n[t]||(n[t]=[])).push({handler:o,handlerRouter:u})},off:function(t,r){if(n[t]){var o=function(t,e){return t.findIndex((function(t){return t.handler===e}))}(n[t],r);o>=0&&(e.events.off(t,n[t][o].handlerRouter),n[t].splice(o,1))}}})}var r=t.prototype;return r.setRoutes=function(t){this.routes={},this.addRoutes(t)},r.addRoutes=function(t){for(var e in t)t.hasOwnProperty(e)&&(this.routes[e]=new s(t[e].pattern,t[e].page))},r.getRoutes=function(){return this.routes},r.match=function(t){for(var e in this.routes)if(this.routes.hasOwnProperty(e)){var r=this.routes[e].match(t);if(r.matched)return u({},r,{route:e})}return{route:"",params:{},query:{},path:t,page:"",hash:"",matched:!1}},r.assemble=function(t,e){if(this.routes[t])return{path:this.routes[t].assemble(e),page:this.routes[t].getPage()};throw new Error("next-router: No route matched")},r.getLinkProps=function(t,e,r){void 0===e&&(e={}),void 0===r&&(r="");var n=this.assemble(t,e);return{href:{pathname:n.page,query:e},as:n.path+(""!==r?"#"+r:"")}},r.getLinkPropsFromHref=function(t,e){void 0===e&&(e=function(t){return t});var r="/"!==t.substr(0,1)?"/"+t:t,n=this.match(e(r));return n.matched?this.getLinkProps(n.route,n.params,n.hash):{href:t,as:t}},r.push=function(t,r,n,o){void 0===r&&(r={}),void 0===n&&(n=""),void 0===o&&(o={});var u=this.getLinkProps(t,r,n);return e.push(u.href,u.as,o)},r.pushHref=function(t,r){void 0===r&&(r={});var n=this.getLinkPropsFromHref(t);return e.push(n.href,n.as,r)},r.replace=function(t,r,n,o){void 0===r&&(r={}),void 0===n&&(n=""),void 0===o&&(o={});var u=this.getLinkProps(t,r,n);return e.replace(u.href,u.as,o)},r.replaceHref=function(t,r){void 0===r&&(r={});var n=this.getLinkPropsFromHref(t);return e.replace(n.href,n.as,r)},r.getRequestHandler=function(t){var e=this;return function(r,n,o){if(r.url.match(/^\/_next|^\/static/))return o();var u=e.match(r.url),i=u.route,a=u.page,s=u.params,h=u.query;if(u.matched&&(e.setCurrentRoute({route:i,page:a,params:s,query:h,hash:u.hash}),t))return t(r,n,a,s,h,i);o()}},r.currentRouteFromMatch=function(t){return{route:t.route,page:t.page,params:t.params,query:t.query,hash:t.hash}},r.setCurrentRoute=function(t){this.currentRoute=t},r.getCurrentRoute=function(){return this.currentRoute},t}(),c=function(t){return function(e){var r,i=e.route,s=e.params,h=void 0===s?{}:s,c=e.hash,p=void 0===c?"":c,f=e.href,l=e.children,v=a(e,["route","params","hash","href","children"]);if(!i&&!f)throw new Error("next-router: You have to provide a route or a href to the Link");return r=u({},i?t.getLinkProps(i,h,p):t.getLinkPropsFromHref(f||""),v),n.createElement(o,Object.assign({},r),l)}},p=function(t,e){return e.match(t.ctx.asPath||"")},f=function(t,e){return e||(e=p),function(r){var o;return(o=function(e){var o,u;function s(){return e.apply(this,arguments)||this}return u=e,(o=s).prototype=Object.create(u.prototype),o.prototype.constructor=o,i(o,u),s.prototype.render=function(){var e=this.props,o=e.initialProps,u=e.nextRouter_currentRoute,i=a(e,["initialProps","nextRouter_currentRoute"]);return t.getCurrentRoute()||t.setCurrentRoute(u),n.createElement(r,Object.assign({},i,o))},s}(n.Component)).getInitialProps=function(n){try{var o=function(){return{nextRouter_currentRoute:c,initialProps:i}},i={},a={route:"",params:{},query:{},path:"",page:"",hash:"",matched:!1};e&&(a=e(n,t)),a.matched||n.ctx.res&&(n.ctx.res.statusCode=404);var s=a.params,h=a.query,c={route:a.route,page:a.page,params:s,query:h,hash:a.hash};t.setCurrentRoute(c),n.ctx.query=u({},h,s);var p=function(){if("getInitialProps"in r)return Promise.resolve(r.getInitialProps.call(r,n)).then((function(t){i=t}))}();return Promise.resolve(p&&p.then?p.then(o):o())}catch(t){return Promise.reject(t)}},o}};exports.LinkFactory=c,exports.RouteClass=s,exports.RouterClass=h,exports.init=function(t,e,r,n){exports.Router=e?new e(t):new h(t),exports.Link=r?r(exports.Router):c(exports.Router),exports.withNextRouter=f(exports.Router,n)},exports.useRouter=function(){if(!exports.Router)throw new Error("next-router: Router is not set. You have to initialize next-router first.");return exports.Router.getCurrentRoute()},exports.withNextRouterFactory=f;
//# sourceMappingURL=next-router.cjs.production.min.js.map
